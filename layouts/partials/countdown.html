{{ $input := . }}


<style>
  time.counter {
    display: flex;
    background-color: #00000096;
    padding: 1.25rem 0;
    border-radius: 1rem;
    border: 0.125rem solid var(--color-primary);
  }

  time.counter .countdown-segment {
    display: flex;
    width: 8rem;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  time.counter .countdown-segment:not(:first-child) {
    border-left: #fff 0.125rem solid;
  }

  time.counter .countdown-segment .countdown-value {
    font-size: 3.125rem;
    font-weight: 600;
    color: #fff;
  }

  time.counter .countdown-segment .countdown-label {
    font-size: 1rem;
    font-weight: 400;
    color: #fff;
  }

  /* Four segments have by default a width if 8rem. */
  @media (max-width: 32rem) {
    time.counter .countdown-segment {
      width: 6rem;
    }

    time.counter .countdown-segment .countdown-value {
      font-size: 2.125rem;
    }

    time.counter .countdown-segment .countdown-label {
      font-size: 0.75rem;
    }
  }
</style>

<time class="counter" datetime="{{ $input.targetDate }}">
  <div class="countdown-segment">
    <span class="countdown-value" id="countdown-days"></span>
    <span class="countdown-label">{{ T "countdown_days" }}</span>
  </div>
  <div class="countdown-segment">
    <span class="countdown-value" id="countdown-hours"></span>
    <span class="countdown-label">{{ T "countdown_hours" }}</span>
  </div>
  <div class="countdown-segment">
    <span class="countdown-value" id="countdown-minutes"></span>
    <span class="countdown-label">{{ T "countdown_minutes" }}</span>
  </div>
  <div class="countdown-segment">
    <span class="countdown-value" id="countdown-seconds"></span>
    <span class="countdown-label">{{ T "countdown_seconds" }}</span>
  </div>
</time>

<script>
  const SECOND_IN_MILLISECONDS = 1000;
  const MINUTE_IN_MILLISECONDS = SECOND_IN_MILLISECONDS * 60;
  const HOUR_IN_MILLISECONDS = MINUTE_IN_MILLISECONDS * 60;
  const DAY_IN_MILLISECONDS = HOUR_IN_MILLISECONDS * 24;

  const daysElement = document.getElementById("countdown-days");
  const hoursElement = document.getElementById("countdown-hours");
  const minutesElement = document.getElementById("countdown-minutes");
  const secondsElement = document.getElementById("countdown-seconds");

  if (!daysElement || !hoursElement || !minutesElement || !secondsElement) {
    throw Error("Countdown elements not found.");
  }

  const end = new Date("{{ $input.targetDate }}");
  let timer;

  function renderCounter() {
    const now = new Date();
    let distance = end - now;
    if (distance < 0) {
      distance = 0;
      clearInterval(timer);
    }

    const days = Math.floor(distance / DAY_IN_MILLISECONDS);
    const hours = Math.floor(
      (distance % DAY_IN_MILLISECONDS) / HOUR_IN_MILLISECONDS
    );
    const minutes = Math.floor(
      (distance % HOUR_IN_MILLISECONDS) / MINUTE_IN_MILLISECONDS
    );
    const seconds = Math.floor(
      (distance % MINUTE_IN_MILLISECONDS) / SECOND_IN_MILLISECONDS
    );

    daysElement.innerHTML = days;
    hoursElement.innerHTML = hours;
    minutesElement.innerHTML = minutes;
    secondsElement.innerHTML = seconds;
  }

  renderCounter();
  timer = setInterval(renderCounter, 1000);
</script>
